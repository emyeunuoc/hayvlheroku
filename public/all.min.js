!function(){function a(a,b,c){function d(){var c=localStorage.getItem("token");b("GET","/api/user",{skip:a.skip,take:a.take,token:c}).then(function(b){a.users=b.data.rows,a.totalAll=b.data.count})}a.skip=0,a.take=5,a.currentPage=1,a.notify={},a.changePage=function(b){a.currentPage=b,a.skip=a.take*a.currentPage-a.take,d()},a.changeStatus=function(c,e){var f=localStorage.getItem("token");b("PUT","/api/user",{token:f,status:c,id:e}).then(function(b){231==b.status&&d(),104==b.status&&(a.notify.message="Ban ko co quyen admin de dung chuc nang nay",a.notify.confirm=null,$("#modalUserNotify").modal("show"))})},a.showDetail=function(c){var d=localStorage.getItem("token");b("GET","/api/user/"+c,{token:d,id:c}).then(function(b){201==b.status&&(a.userDetail=b.data.rows[0],$("#modalUserDetail").modal("show"))})},a.prepareDeteteUser=function(b){a.notify.message="Ban co muon xoa ?",a.notify.confirm=b,$("#modalUserNotify").modal("show")},a.deleteUser=function(c){a.notify.confirm=null;var e=localStorage.getItem("token");b("DELETE","/api/user",{token:e,id:c}).then(function(b){221==b.status?(a.notify.message="Xoa thanh cong",d()):222==b.status?a.notify.message="Da co loi xay ra phia server,chung toi se fix ngay lap tuc":104==b.status&&(a.notify.message="Ban ko co quyen admin de dung chuc nang nay"),$("#modalUserNotify").modal("show")})},d()}myController.controller("adminAcountList",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c){a.getPage=function(){b("GET","/api/category",{skip:a.skip,take:a.take}).then(function(b){a.category=b.data.rows,a.totalAll=b.data.count})},a.getPage(),a.clear=function(){a.title=$scopeId=a.description=a.mode=""},a.preAdd=function(){a.mode="Add",$("#addUpdateModal").modal("show")},a.preUpdate=function(b,c,d){a.mode="Update",a.id=d,a.title=b,a.description=c,$("#addUpdateModal").modal("show")},a.preDelete=function(b){a.id=b,a.notify="Ban co muon xoa?",a.mode="Delete",$("#notify").modal("show")},a.submit=function(c,d){if("Add"==c&&d){var e=localStorage.getItem("token"),f={token:e,title:a.title,description:a.description};b("POST","/api/category",f).then(function(b){104==b.status?(a.notify="Ban khong co quyen de su dung tinh nang nay",$("#notify").modal("show")):312==b.status?(a.notify="Categogy nay da ton tai roi",$("#notify").modal("show")):311==b.status&&(a.notify="Add thanh cong",$("#notify").modal("show")),a.clear(),$("#addUpdateModal").modal("hide")})}else if("Update"==c&&d){var e=localStorage.getItem("token"),f={token:e,title:a.title,description:a.description,id:a.id};b("PUT","/api/category",f).then(function(b){104==b.status?(a.notify="Ban khong co quyen de su dung tinh nang nay",$("#notify").modal("show")):332==b.status?(a.notify="Categogy nay da ton tai roi,update khong thanh cong",$("#notify").modal("show")):331==b.status&&(a.notify="Update thanh cong",$("#notify").modal("show"),a.getPage()),a.clear(),$("#addUpdateModal").modal("hide")})}else if("Delete"==c){var e=localStorage.getItem("token"),f={token:e,id:a.id};b("DELETE","/api/category",f).then(function(b){104==b.status?(a.notify="Ban khong co quyen de su dung tinh nang nay",$("#notify").modal("show")):322==b.status?(a.notify="Categogy nay da ton tai bai viet, hay xoa bai viet do truoc",$("#notify").modal("show")):321==b.status&&(a.notify="Delete thanh cong",$("#notify").modal("show"),a.getPage()),a.clear(),$("#addUpdateModal").modal("hide")})}},$("#notify").on("hidden.bs.modal",function(a){$("body").css("padding-right","0px")})}myController.controller("adminCategory",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c){a.logout=function(){localStorage.removeItem("password"),localStorage.removeItem("username"),localStorage.removeItem("token"),a.username=localStorage.getItem("username"),c.path("/admin/login").replace()},a.isLogin=function(){return a.username=localStorage.getItem("username"),localStorage.getItem("token")}}myController.controller("header",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c){function d(){b("GET","/api/view").then(function(b){a.views=b.views})}d(),b("GET","/api/authenticate",{token:localStorage.getItem("token")}).then(function(a){a.success||c.path("/admin/login").replace()}),a.loadView=function(){d()}}myController.controller("adminIndex",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c){b("GET","/api/authenticate",{token:localStorage.getItem("token")}).then(function(a){a.success&&c.path("/admin").replace()}),a.submit=function(){if(!(!a.inputUser||!a.inputPassword||a.inputPassword.length<5||a.inputPassword>12||a.inputUser.length<5||a.inputUser>12)){var d={username:a.inputUser,password:a.inputPassword};b("POST","/api/login",d).then(function(b){b.success?(a.loginErr=null,localStorage.setItem("username",d.username),localStorage.setItem("password",d.password),localStorage.setItem("token",b.token),c.path("/admin/index").replace()):(a.loginErr=b.notify,$("#loginNotify").modal("show"))})}}}myController.controller("adminLogin",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c,d){a.notify={},a.videoLink="",a.coverImg="",b("GET","/api/category",{}).then(function(b){301==b.status&&(a.preCategory=b.data.rows)}),a.submit=function(c){if(c){var d=localStorage.getItem("token"),e={title:a.title,categoryId:a.category,description:a.description,content:a.content,videoLink:a.videoLink,coverImg:a.coverImg,token:d};b("POST","/api/post",e).then(function(b){411==b.status?(a.notifyFn("saveSuccess"),a.back=function(){a.notifyFn("cancel")}):108==b.status&&(a.notifyFn("band"),a.back=function(){a.notifyFn("cancel")})})}},a.notifyFn=function(b){"preCancel"==b?(a.notify.message="Ban co muon huy bo",a.notify.confirm="cancel",$("#modaPostAddNotify").modal("show")):"cancel"==b?($(".modal-backdrop").remove(),$("body").css("padding-right","0px"),c.path("/admin/post/list")):"saveSuccess"==b?(a.notify.message="Da luu",a.notify.confirm=null,$("#modaPostAddNotify").modal("show")):"band"==b&&(a.notify.message="Tai khoan cua ban da bi cam",a.notify.confirm=null,$("#modaPostAddNotify").modal("show"))},a.watchDemo=function(){$(".watchDemo").find("img").addClass("img-responsive"),$("#watchDemo").modal("show")}}myController.controller("adminPostAdd",a),a.$inject=["$scope","apiService","$location","$sce"]}(),function(){function a(a,b,c){function d(){b("GET","/api/category",{}).then(function(b){301==b.status&&(a.listCategory=b.data.rows)})}a.notify={},a.notify.confirm=!1,a.skip=0,a.take=5,a.currentPage=1,a.changePage=function(b){a.currentPage=b,a.skip=a.take*a.currentPage-a.take,a.load()},a.load=function(){b("GET","/api/post",{skip:a.skip,take:a.take,noCount:!0}).then(function(b){401==b.status&&(a.dropDownTitle="Tat ca",a.posts=b.data.rows,a.totalAll=b.data.count)})},a.loadPostWithCategory=function(c,d){a.skip=0,a.take=5,a.currentPage=1,b("GET","/api/post/category/"+c,{skip:a.skip,take:a.take}).then(function(b){441==b.status&&(a.dropDownTitle=d,a.posts=b.data.rows,a.totalAll=b.data.count)})},a.load(),d(),a.editPost=function(d){var e=localStorage.getItem("token");b("POST","/api/authenticate",{token:e,postId:d}).then(function(b){105==b.status?c.path("/admin/post/update/"+d).replace():(b.status=106)&&(a.notify.message="Day khong phai bai viet cua ban",$("#modalPostListNotify").modal("show"))})},a.preDeletePost=function(b){0==a.notify.confirm?(console.log(a.notify.confirm),a.notify.message="Ban co muon xoa bai viet",a.notify.confirm=b,$("#modalPostListNotify").modal("show"),console.log(a.notify.confirm)):(console.log("2"),a.deletePost(b),a.notify.confirm=!1)},a.deletePost=function(c){var d=localStorage.getItem("token");b("DELETE","/api/post",{token:d,postId:c,id:c}).then(function(b){421==b.status?(a.notify.message="Da xoa bai viet",$("#modalPostListNotify").modal("show"),a.load()):(b.status=106)&&(a.notify.message="Day khong phai bai viet cua ban",$("#modalPostListNotify").modal("show"))})}}myController.controller("adminPostList",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c){a.notify={},a.submitForm=function(c){if(c){var d=localStorage.getItem("token"),e={token:d,username:a.username,password:a.password,age:a.age,telephone:a.telephone,gender:a.gender,email:a.email};console.log(e),b("POST","/api/user",e).then(function(b){console.log(b),211==b.status?a.notify.message="Da tao user":104==b.status?a.notify.message="Ban khong co quyen admin de su dung tinh nag nay":212==b.status&&(a.notify.message="Da ton tai user"),$("#modalUserAddNotify").modal("show")})}}}myController.controller("adminAddUser",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(a,b,c,d,e){a.notify={},a.back=function(){};var f=e.updateId;f||c.path("/admin").replace(),b("GET","/api/post/"+f,{}).then(function(d){402==d.status?c.path("/admin").replace():401==d.status&&(a.title=d.data.rows[0].title,a.description=d.data.rows[0].description,a.category=d.data.rows[0].categoryId,a.content=d.data.rows[0].content,a.videoLink=d.data.rows[0].videoLink,a.coverImg=d.data.rows[0].coverImg,a.id=d.data.rows[0].id),b("GET","/api/category",{}).then(function(b){301==b.status&&(a.preCategory=b.data.rows)})}),a.submit=function(c){if(c){var d=localStorage.getItem("token");void 0==a.videoLink&&(a.videoLink="");var e={title:a.title,categoryId:a.category,description:a.description,content:a.content,id:a.id,postId:a.id,videoLink:a.videoLink,coverImg:a.coverImg,token:d};b("PUT","/api/post",e).then(function(b){431==b.status&&(a.notifyFn("saveSuccess"),a.back=function(){a.notifyFn("cancel")})})}},a.notifyFn=function(b){"preCancel"==b?(a.notify.message="Ban co muon huy bo",a.notify.confirm="cancel",$("#modaPostAddNotify").modal("show")):"cancel"==b?($(".modal-backdrop").remove(),$("body").css("padding-right","0px"),c.path("/admin/post/list")):"saveSuccess"==b&&(a.notify.message="Da luu",a.notify.confirm=null,$("#modaPostAddNotify").modal("show"))},a.watchDemo=function(){$(".watchDemo").find("img").addClass("img-responsive"),$("#watchDemo").modal("show")}}myController.controller("adminPostUpdate",a),a.$inject=["$scope","apiService","$location","$sce","$stateParams"]}(),function(){function a(a,b,c,d,e,f){function g(){b("GET","/api/category",{}).then(function(b){301==b.status&&(a.listCategory=b.data.rows)})}a.notify={},a.notify.confirm=!1,a.take=9,a.currentPage=parseInt(e.page),"NaN"==a.currentPage.toString()&&d.go("error"),a.skip=a.take*a.currentPage-a.take,a.changePage=function(b){a.currentPage=b,a.skip=a.take*a.currentPage-a.take,a.load()},a.load=function(){f.start(),b("GET","/api/post",{skip:a.skip,take:a.take}).then(function(b){f.complete(),401==b.status&&(a.dropDownTitle="Tat ca",a.posts=b.data.rows,a.totalAll=b.data.count,d.go("index",{page:a.currentPage},{notify:!1,reload:!1}))})},a.load(),g()}myController.controller("index",a),a.$inject=["$scope","apiService","$location","$state","$stateParams","cfpLoadingBar"]}(),function(){function a(a,b,c,d,e,f){function g(){b("GET","/api/category",{}).then(function(b){301==b.status&&(a.listCategory=b.data.rows)})}a.notify={},a.notify.confirm=!1,a.take=9,a.currentPage=parseInt(e.page),a.skip=a.take*a.currentPage-a.take;var h=parseInt(e.cate);"NaN"==h.toString()|"NaN"==a.currentPage.toString()&&d.go("error"),a.changePage=function(b){a.currentPage=b,a.skip=a.take*a.currentPage-a.take,a.load()},a.load=function(){f.start(),b("GET","/api/post/category/"+h,{skip:a.skip,take:a.take}).then(function(b){f.complete(),441==b.status&&(a.dropDownTitle="Tat ca",a.posts=b.data.rows,a.totalAll=b.data.count,d.go("category",{page:a.currentPage},{notify:!1,reload:!1}))})},a.load(),g()}myController.controller("indexCategory",a),a.$inject=["$scope","apiService","$location","$state","$stateParams","cfpLoadingBar"]}(),function(){function a(a,b,c,d,e,f,g){a.link=e.film,g.start(),b("GET","/api/post/link/"+a.link,{}).then(function(b){g.complete(),452==b.status?d.go("error"):451==b.status&&(a.title=b.data.rows[0].title,a.description=b.data.rows[0].description,a.category=b.data.rows[0].categoryId,a.content=b.data.rows[0].content,a.videoLink=b.data.rows[0].videoLink,a.coverImg=b.data.rows[0].coverImg,a.id=b.data.rows[0].id,f(function(){$("#film-content").children().find("img").addClass("img-responsive")},300))})}myController.controller("film",a),a.$inject=["$scope","apiService","$location","$state","$stateParams","$timeout","cfpLoadingBar"]}(),function(){function a(a,b,c){a.getPage=function(){b("GET","/api/category",{}).then(function(b){a.category=b.data.rows})},a.getPage(),a.getLink=function(a,b){return b=b.toLowerCase(),b=b.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),b=b.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),b=b.replace(/ì|í|ị|ỉ|ĩ/g,"i"),b=b.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ  |ợ|ở|ỡ/g,"o"),b=b.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),b=b.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),b=b.replace(/đ/g,"d"),b=a+"-"+b.split(/[^a-z0-9]+/).join("-")}}myController.controller("indexHeader",a),a.$inject=["$scope","apiService","$location"]}(),function(){function a(){return{restrict:"A",scope:{},link:function(a,b,c){function d(){$(b).prev().children(".my-tooltiptext").css("width",$(b).css("width"));var a=$(b).prev().children(".my-tooltiptext").html();return a?void $(b).prev().children(".my-tooltiptext").removeClass("disable"):void $(b).prev().children(".my-tooltiptext").addClass("disable")}$(".my-tooltiptext").addClass("disable"),$(window).resize(function(){$(b).prev().children(".my-tooltiptext").css("width",$(b).css("width"))}),$(b).keyup(function(){d()}),$(b).on("paste delete cut",function(){setTimeout(function(){d()},100)}),$(b).focus(function(){d(),$(b).prev().children(".my-tooltiptext").removeClass("disable")}),$(b).blur(function(){d(),$(b).prev().children(".my-tooltiptext").addClass("disable")})}}}myDirective.directive("ngCheckInput",a)}(),function(){function a(a){return{templateUrl:"template/linkVideo.template.html",link:function(b,c,d){b.$watch("link",function(c,d){c&&(b.config={preload:"none",sources:[{src:a.trustAsResourceUrl(b.link),type:"video/mp4"}],tracks:[{src:"pale-blue-dot.vtt",kind:"subtitles",srclang:"en",label:"English",default:""}],theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"}})},!0)},scope:{link:"="}}}a.$inject=["$sce"],myDirective.directive("linkVideo",a)}(),function(){function a(){return{template:'<nav>\t<ul class="pagination">  \t\t<li class="{{currentPage == 1 ? \'disabled\' : \'\'}}"><a href="" ng-click="prev()">Previous</a></li>  \t\t<li class="{{isActive(key + 1)}}" ng-if="isHead()" ng-repeat="(key, value) in getNumber()  track by $index" ng-show="countPage()>10">  \t\t\t<a href="" ng-click="changePage(key + 1 )">{{key + 1 }}</a>  \t\t</li>  \t\t<li class="{{isActive(countPage() + key - 9 )}}" ng-if="isTail()" ng-repeat="(key, value) in getNumber()  track by $index" ng-show="countPage()>10"> \t\t\t<a href="" ng-click="changePage(countPage() + key - 9)">{{countPage() + key - 9}}</a> \t\t</li>  \t\t<li class="{{isActive(currentPage - 5 + key)}}" ng-if="isCenter()" ng-repeat="(key, value) in getNumber()  track by $index"  ng-show="countPage()>10"> \t\t\t<a href="" ng-click="changePage(currentPage - 5 + key)">{{currentPage - 5 + key}}</a> \t\t</li> \t\t<li class="{{isActive(key + 1)}}" ng-repeat="(key, value) in getNumber() track by $index" ng-if="countPage()<=10">\t\t\t<a href="" ng-click="changePage(key + 1 )">{{key + 1 }}</a>  \t\t</li> \t\t<li class="{{countPage() == currentPage ? \'disabled\' : \'\'}} " ng-click="next()"><a href="">Next</a></li> \t</ul> </nav>',link:function(a,b,c){a.$watch("totalItems",function(b,c){b&&a.countPage()<a.currentPage&&a.changePage(a.countPage())},!0),a.countPage=function(){return Math.ceil(a.totalItems/a.itemsPerPage)},a.isHead=function(){return a.currentPage<7},a.isTail=function(){return a.currentPage>a.countPage()-5},a.isCenter=function(){return!a.isHead()&&!a.isTail()},a.getNumber=function(){return a.countPage()<10?new Array(a.countPage()):new Array(10)},a.isActive=function(b){return a.currentPage==b?"active":""},a.changePage=function(b){b>a.countPage()&&(b=a.countPage()),a.change()(b)},a.prev=function(){1!=a.currentPage&&a.changePage(a.currentPage-1)},a.next=function(){a.currentPage!=a.countPage()&&a.changePage(a.currentPage+1)}},scope:{totalItems:"=",currentPage:"=",itemsPerPage:"=",change:"&"}}}myDirective.directive("pagging",a)}(),function(){myFilter.filter("to_trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}])}(),function(){function a(a,b,c){return function(d,e,f){var g=a.defer();if("GET"==d)b({url:e,method:"GET",params:f}).then(function(a){103!=a.data.status&&102!=a.data.status||c.path("/admin/login").replace(),g.resolve(a.data)},function(a){g.reject(a)});else{var h={method:d,url:e,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:f};b(h).then(function(a){103!=a.data.status&&102!=a.data.status||c.path("/admin/login").replace(),g.resolve(a.data)},function(a){g.reject(a)})}return g.promise}}myService.service("apiService",a),a.$inject=["$q","$http","$location"]}();